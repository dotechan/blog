<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Work From Dote - AndroidアプリにDDDを適応する-戦略的設計- </title>

    
    
    <meta content="Android, DDD, 技術" name="keywords">
    
    <meta content="Work From Dote - DDDを実践してAndroidアプリ開発をしていこうって話です" name="description">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    

    

    

    
    
    <script type="text/javascript" async
        src="https://dotechan.github.io/blog//mathjax-3.0.0/tex-mml-chtml.js">
    </script>
    

    <link rel="stylesheet" href="https://dotechan.github.io/blog//layui/css/layui.css">
    <link rel="stylesheet" href="https://dotechan.github.io/blog//self/css/default.css">
    <script src="https://dotechan.github.io/blog//layui/layui.js"></script>


    <link rel="stylesheet" async href="https://dotechan.github.io/blog//self/css/markdown.min.css">
    <link rel="stylesheet" async href="https://dotechan.github.io/blog//self/css/gallery.css">
    <link rel="stylesheet" async href="https://dotechan.github.io/blog//font-awesome-4.7.0/css/font-awesome.min.css">
    <script src="https://dotechan.github.io/blog//self/js/lazysizes.min.js" async></script></head>

<body>
    
    <header class="layui-header layui-bg-cyan">

    
    
    <a class="nav-self-logo" href="https://dotechan.github.io/blog/">
        Work From Dote
    </a>

    <ul class="layui-nav layui-layout-right layui-bg-cyan" lay-filter="">
        
        
        <li class="layui-nav-item" id="nav_big"><a href="https://dotechan.github.io/blog//post/">Posts</a></li>
        

        

        
        <li class="layui-nav-item" id="nav_small">
            <a href="javascript:;">
                <i class="layui-icon layui-icon-app" style="font-size: 24px;"></i>
            </a>

            <dl class="layui-nav-child">
                
                <dd><a href="https://dotechan.github.io/blog//post/">Posts</a></dd>
                

                
            </dl>
        </li>
    </ul>
</header>

<script>
layui.use('element', function(){
  var element = layui.element;
});
</script>

        <div id="content" style="min-height:80%">
<div class="layui-container" style="margin-bottom: 10px">
    

    <div class="layui-row layui-col-space10">
        <div class="layui-col-md8 layui-col-sm12 layui-col-xs12">
            <div class="layui-card single-card">
                <br />
                <blockquote class="layui-elem-quote markdown-body single-title" >
                    <h1>AndroidアプリにDDDを適応する-戦略的設計-</h1>
                    <h3 style="margin-top:10px; margin-bottom:10px"> 
    <i class="layui-icon layui-icon-date" style="font-size: 24px; vertical-align: -2px;"></i>
    <span>2020-06-06</span>

    
    <i class="layui-icon layui-icon-tabs" style="font-size: 22px; vertical-align: 0px;"></i>
    
        <a href="/blog/tags/android/">
            <span class="layui-badge" style="vertical-align: 2px;">Android</span>
        </a>
    
        <a href="/blog/tags/ddd/">
            <span class="layui-badge" style="vertical-align: 2px;">DDD</span>
        </a>
    
</h3>
                </blockquote>
                <div class="layui-card-body markdown-body single-content">
                    <div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_はじめに">はじめに</a></li>
<li><a href="#_参考記事">参考記事</a></li>
<li><a href="#_作ろうとしているアプリ">作ろうとしているアプリ</a></li>
<li><a href="#_dddの戦略的設計の流れ">DDDの戦略的設計の流れ</a>
<ul class="sectlevel2">
<li><a href="#_アプリのドメインについて考える">アプリのドメインについて考える</a></li>
<li><a href="#_ユビキタス言語を育てる">ユビキタス言語を育てる</a></li>
<li><a href="#_境界づけられたコンテキストを見つける">境界づけられたコンテキストを見つける</a></li>
<li><a href="#_コンテキストマップを描く">コンテキストマップを描く</a></li>
<li><a href="#_アーキテクチャの検討">アーキテクチャの検討</a></li>
</ul>
</li>
<li><a href="#_まとめ">まとめ</a></li>
</ul>
</div>
<div class="sect1">
<h2 id="_はじめに">はじめに</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ビジネスに適応するソフトウェアを作るにはどうすればいいのか模索している中でDDDの存在を知りました。<br>
勉強がてら個人のAndroidアプリ開発でDDDを実践しようとしましたが、技術的なパターンを取り入れてはいるものの<br>
どこかしっくりこず、DDDへの理解が深まらない中でアプリ開発を進めている状況でした。</p>
</div>
<div class="paragraph">
<p>そんな中でAndroidアプリへのDDDの適応方法を調べていて参考記事に出会いました。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_参考記事">参考記事</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="http://y-anz-m.blogspot.com/2017/03/droidkaigi-2017_9.html">ドメイン駆動設計について DroidKaigi 2017 で登壇しました。</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_作ろうとしているアプリ">作ろうとしているアプリ</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ついつい無意識にいじってしまうスマホ、どのくらいスマホに依存しているのか？<br>
依存度を可視化してみようという大義名分の元にスマホの使用回数がわかるアプリを作ります。<br>
実は裏テーマがありますがここでは伏せておきます😂</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_dddの戦略的設計の流れ">DDDの戦略的設計の流れ</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>アプリのドメインについて考える</p>
</li>
<li>
<p>ユビキタス言語を育てる</p>
</li>
<li>
<p>境界づけられたコンテキストを見つける</p>
</li>
<li>
<p>コンテキストマップを描く</p>
</li>
<li>
<p>アーキテクチャの検討</p>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="_アプリのドメインについて考える">アプリのドメインについて考える</h3>
<div class="paragraph">
<p>改めてドメインとは何か？<br>
ドメインとはソフトウェアによって解決したい「問題領域」のことである。<br>
要はユーザーがアプリを利用する対象領域と考えることができる。</p>
</div>
<div class="paragraph">
<p>ユーザーがレシピ検索アプリを使うのは「レシピ検索をしたい」からであり<br>
そうするとドメインは <strong>レシピ検索</strong> だと考えられる。<br>
レシピ検索ドメインの裏には <strong>美味しい料理を食べたい</strong> という問題提起が背景にあるかな？<br>
とか思ったが、ドメインを考える前の話な気もするのでここでの深堀はやめておく。</p>
</div>
<div class="paragraph">
<p>個人のAndroidアプリ作成時にやりたいことを考えた後にいきなりユビキタス言語を探しており<br>
なかなかユビキタス言語を見つけられなかった(しっくりこなかった)が、この工程が抜けていた。</p>
</div>
<div class="sect3">
<h4 id="_実践">実践</h4>
<div class="paragraph">
<p>ユーザーはスマホの使用率・使用回数を知りたい時に本アプリを利用します。<br>
そのためドメインは「スマホ使用率の確認」になります。<br>
スマホ使用率の定義は迷いましたが、今回は「ホーム画面を表示した回数」としました。<br>
ついつい用もないのにホーム画面開いちゃう、あれって完全にスマホ依存ですよね・・・</p>
</div>
<div class="paragraph">
<p>ドメインについてしっかり考えないと不要な機能作っちゃったり、やりたいことから<br>
それてしまうなと思いました。</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ユビキタス言語を育てる">ユビキタス言語を育てる</h3>
<div class="sect3">
<h4 id="_実践_2">実践</h4>
<div class="paragraph">
<p>現段階で思いついたのは以下です。</p>
</div>
<div class="literalblock">
<div class="content">
<pre>スマホ使用率(＝ホーム画面の表示回数)
 - 記録する
 - 確認する
 - リセットする
履歴
 - 記録する
 - 確認する</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_境界づけられたコンテキストを見つける">境界づけられたコンテキストを見つける</h3>
<div class="paragraph">
<p>言語の境界がコンテキストの境界になる。<br>
ユビキタス言語が通じる範囲だと考えると自分が考えていたパッケージ構成だと<br>
わかりにくいという気付きがあった。<br>
境界づけられたコンテキスト(個人のアプリでは機能単位になりそう)毎に<br>
パッケージを作成し、その中でdomainパッケージなどを作成する構成にしてみよう。</p>
</div>
<div class="sect3">
<h4 id="_実践_3">実践</h4>
<div class="ulist">
<ul>
<li>
<p>スマホ使用率コンテキスト</p>
</li>
<li>
<p>履歴コンテキスト</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>スマホ使用率コンテキストだけで大義名分は果たせそうな気もするのですが<br>
コンテキストが1つだけだと学習のテーマ的に物足りないので履歴コンテキストも足しました。<br>
まあ裏テーマではこの履歴が大事になるので必要なコンテキストになります。<br>
機能追加していく時にコンテキストは増えていくのだろう。<br></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_コンテキストマップを描く">コンテキストマップを描く</h3>
<div class="paragraph">
<p>境界づけられたコンテキスト間の関係性を図化したものがコンテキストマップである。<br>
サーバとの通信やDBといった技術要素に引っ張られて、やりとりする先の事情が<br>
ドメイン知識を汚しがちになっていることに気がつけた<br>
例えば、サーバからのレスポンスが文字列だからドメインオブジェクトでも文字列として<br>
扱っていると表現力が乏しくなる。<br>
そういった時は腐敗防止層を取り入れてドメインオブジェクトへの変換を行うようにしてみる。</p>
</div>
<div class="sect3">
<h4 id="_実践_4">実践</h4>
<div class="paragraph">
<p>hugoでの画像の挿入がうまくいかなかったから画像は省略・・・</p>
</div>
<div class="paragraph">
<p>DBとの間に腐敗防止層を設けるべきか？それをコンテキストマップ上で表現すべきか？<br>
については自分の中に指針がないので勉強しながらどうすべきかを模索していこうと思います。</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_アーキテクチャの検討">アーキテクチャの検討</h3>
<div class="paragraph">
<p>DDDはアーキテクチャに依存しない。<br>
やりたいことはドメインを隔離することであり、その手法としてレイヤードアーキテクチャがある。</p>
</div>
<div class="paragraph">
<p>Androidアプリ開発でよく聞くFatActivityはドメインがUIに記述されてしまいおきている。<br></p>
</div>
<div class="sect3">
<h4 id="_smart_ui">Smart UI</h4>
<div class="paragraph">
<p>なぜUIにドメイン知識やビジネスロジックをつめこんでしまうのか？<br>
それはアプリの作り方に関わってくる。<br></p>
</div>
<div class="paragraph">
<p>SmartUIのメリットをみていくとイメージが掴みやすい。<br>
* 単純なアプリケーションの場合すぐに作れる
* Frameworkに従うだけで訓練していない人でも作れる</p>
</div>
<div class="paragraph">
<p>上記なようなメリットがあるため、人は楽な方に倒しがちなのでFatActivityなどが<br>
生まれてしまうんだなと思いました。<br>
UIは利口になりがちだと認識した上でドメイン知識にUIの事情を混入させないように意識してみます。</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_まとめ">まとめ</h2>
<div class="sectionbody">
<div class="paragraph">
<p>テーマが簡単かもしれませんが、DDDの戦略的設計はこんなところでしょうか。<br>
次回は戦術的設計に入っていきたいと思います。</p>
</div>
</div>
</div>
</div>
            </div>
        </div>

        
        <div class="layui-col-md4 layui-col-sm12 layui-col-xs12">
            <div class="layui-card single-card">
                <h1 class="single-title">Relevant Topics</h1>
                
                	
                    <div style="margin-left: 10px;">
                        <blockquote class="layui-elem-quote" style="background-color:#FFFFFF;margin-top: 10px;">
                            <a href="/blog/2020/06/03/techbooster_domain_mochico/">
                                <h2 class="">わかる！ドメイン駆動設計〜もちこちゃんの大冒険〜</h2>
                            </a>
                            <h3 style="margin-top:10px; margin-bottom:10px"> 
    <i class="layui-icon layui-icon-date" style="font-size: 24px; vertical-align: -2px;"></i>
    <span>2020-06-03</span>

    
    <i class="layui-icon layui-icon-tabs" style="font-size: 22px; vertical-align: 0px;"></i>
    
        <a href="/blog/tags/ddd/">
            <span class="layui-badge" style="vertical-align: 2px;">DDD</span>
        </a>
    
</h3>
                        </blockquote>
                    </div>
                	
                    <div style="margin-left: 10px;">
                        <blockquote class="layui-elem-quote" style="background-color:#FFFFFF;margin-top: 10px;">
                            <a href="/blog/2020/05/06/android_style_theme/">
                                <h2 class="">Androidのstyleとtheme</h2>
                            </a>
                            <h3 style="margin-top:10px; margin-bottom:10px"> 
    <i class="layui-icon layui-icon-date" style="font-size: 24px; vertical-align: -2px;"></i>
    <span>2020-05-06</span>

    
    <i class="layui-icon layui-icon-tabs" style="font-size: 22px; vertical-align: 0px;"></i>
    
        <a href="/blog/tags/android/">
            <span class="layui-badge" style="vertical-align: 2px;">Android</span>
        </a>
    
        <a href="/blog/tags/theme/">
            <span class="layui-badge" style="vertical-align: 2px;">theme</span>
        </a>
    
        <a href="/blog/tags/style/">
            <span class="layui-badge" style="vertical-align: 2px;">style</span>
        </a>
    
</h3>
                        </blockquote>
                    </div>
                	
                
                <br />
            </div>
        </div>
        
    </div>
</div>


        </div><footer>
    

    <div class="layui-container">
        <div class="layui-row">
            <div class="layui-col-md4 layui-col-sm6 layui-col-xs6">
                <h3> Related Sites </h3>
            </div>
        </div>
        <div class="layui-row">
            
            <div class="layui-col-md4 layui-col-sm6 layui-col-xs12">
                <a href=""><p class="footer-url">home</p></a>
            </div>
            
        </div>
    </div>
    
    
    <div class="layui-container">
        <p class="copyright">&copy; All rights reserved. Powered by <a href='https://gohugo.io' style='color:#FFFFFF'>Hugo</a> and <a href='https://github.com/ertuil/erblog' style='color:#FFFFFF'>Erblog</a>.</p>
    </div>
</footer>
</body>
</html>
